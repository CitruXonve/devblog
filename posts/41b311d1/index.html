<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>ACM竞赛Java模板[dev-160504] - CitruXonve&#039;s another far end</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="CitruXonve&#039;s another far end"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="CitruXonve&#039;s another far end"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Java Code Template By Semprathlon    部分理论知识引用自维基百科  Input 输入An enhanced InputReader supporting keeping reading data until the end of input while the number of input cases is unknown:一个加强版的输入器 ，支持读"><meta property="og:type" content="blog"><meta property="og:title" content="ACM竞赛Java模板[dev-160504]"><meta property="og:url" content="https://devblog.citruxonve.net/posts/41b311d1/"><meta property="og:site_name" content="CitruXonve&#039;s another far end"><meta property="og:description" content="Java Code Template By Semprathlon    部分理论知识引用自维基百科  Input 输入An enhanced InputReader supporting keeping reading data until the end of input while the number of input cases is unknown:一个加强版的输入器 ，支持读"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://devblog.citruxonve.net/2016/04/icpc_logo.png"><meta property="article:published_time" content="2016-04-06T10:04:23.000Z"><meta property="article:modified_time" content="2025-08-18T06:23:06.896Z"><meta property="article:author" content="Semprathlon / Simfae Dean"><meta property="article:tag" content="Template"><meta property="article:tag" content="Java"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://devblog.citruxonve.net/2016/04/icpc_logo.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://devblog.citruxonve.net/posts/41b311d1/"},"headline":"ACM竞赛Java模板[dev-160504]","image":["https://devblog.citruxonve.net/2016/04/icpc_logo.png"],"datePublished":"2016-04-06T10:04:23.000Z","dateModified":"2025-08-18T06:23:06.896Z","author":{"@type":"Person","name":"Semprathlon / Simfae Dean"},"publisher":{"@type":"Organization","name":"CitruXonve's another far end","logo":{"@type":"ImageObject","url":"https://devblog.citruxonve.net/img/logo.svg"}},"description":"Java Code Template By Semprathlon    部分理论知识引用自维基百科  Input 输入An enhanced InputReader supporting keeping reading data until the end of input while the number of input cases is unknown:一个加强版的输入器 ，支持读"}</script><link rel="canonical" href="https://devblog.citruxonve.net/posts/41b311d1/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="CitruXonve&#039;s another far end" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">CrXon Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Icarus Theme on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2016-04-06T10:04:23.000Z" title="4/6/2016, 10:04:23 AM">04/06/2016</time></span><span class="level-item">Updated&nbsp;<time dateTime="2025-08-18T06:23:06.896Z" title="8/18/2025, 6:23:06 AM">08/18/2025</time></span><span class="level-item"> Semprathlon / Simfae Dean </span><span class="level-item"><a class="link-muted" href="/categories/ACM-ICPC/">ACM-ICPC</a></span><span class="level-item">an hour read (About 7280 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">ACM竞赛Java模板[dev-160504]</h1><div class="content"><p><img src="/2016/04/icpc_logo.png" alt="ACM-ICPC"></p>
<h1 align="center">
  Java Code Template By Semprathlon
</h1>

<ul>
<li>部分理论知识引用自维基百科</li>
</ul>
<h1 id="Input-输入"><a href="#Input-输入" class="headerlink" title="Input 输入"></a>Input 输入</h1><p>An enhanced <code>InputReader</code> supporting keeping reading data until the end of input while the number of input cases is unknown:<br>一个加强版的<code>输入器</code> ，支持读到输入文件末尾的方式，用法类似<code>java.util.Scanner</code>但效率显著提高:</p>
<span id="more"></span>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">InputReader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> BufferedReader reader;</span><br><span class="line">    <span class="keyword">public</span> StringTokenizer tokenizer;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">InputReader</span><span class="params">(InputStream stream)</span> &#123;</span><br><span class="line">        reader = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(stream), <span class="number">32768</span>);</span><br><span class="line">        tokenizer = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> tokenizer != <span class="literal">null</span> &amp;&amp; tokenizer.hasMoreTokens() || nextLine() != <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">nextLine</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">tmp</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            tmp = reader.readLine();</span><br><span class="line">            tokenizer = <span class="keyword">new</span> <span class="title class_">StringTokenizer</span>(tmp);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NullPointerException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tmp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (tokenizer == <span class="literal">null</span> || !tokenizer.hasMoreTokens()) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                tokenizer = <span class="keyword">new</span> <span class="title class_">StringTokenizer</span>(reader.readLine());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tokenizer.nextToken();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">nextInt</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Integer.parseInt(next());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">nextLong</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Long.parseLong(next());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">nextDouble</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Double.parseDouble(next());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Keeping reading data until the end of input：<br>读取数据直至文件末尾：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="type">InputReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputReader</span>(System.in);</span><br><span class="line">		<span class="keyword">while</span> (in.hasNext()) &#123;</span><br><span class="line">                    <span class="comment">// TODO ...</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Output-输出"><a href="#Output-输出" class="headerlink" title="Output 输出"></a>Output 输出</h1><p><code>import java.io.PrintWriter;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PrintWriter</span>(System.out);</span><br><span class="line"><span class="comment">// TODO ...</span></span><br><span class="line">out.flush(); <span class="comment">// 更新缓冲区，使输出生效</span></span><br><span class="line">out.close();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Data-Structure-数据结构篇"><a href="#Data-Structure-数据结构篇" class="headerlink" title="Data Structure 数据结构篇"></a>Data Structure 数据结构篇</h1><h2 id="Pair-二元组"><a href="#Pair-二元组" class="headerlink" title="Pair 二元组"></a>Pair 二元组</h2><p> <code>Pair.make_pair(TypeA left,TypeB right)</code>可构造一个二元组对象并返回，不必指定类型。<br> 比较大小时默认先比较left，若left相同则再比较right。<br> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Pair</span>&lt;TypeA <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;TypeA&gt;, TypeB <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;TypeB&gt;&gt; <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;Pair&lt;TypeA, TypeB&gt;&gt; &#123;</span><br><span class="line">	TypeA left;</span><br><span class="line">	TypeB right;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Pair</span><span class="params">()</span> &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Pair</span><span class="params">(TypeA first, TypeB second)</span> &#123;</span><br><span class="line">		left = first;</span><br><span class="line">		right = second;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> &lt;TypeA <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;TypeA&gt;, TypeB <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;TypeB&gt;&gt; Pair&lt;TypeA, TypeB&gt; <span class="title function_">make_pair</span><span class="params">(</span></span><br><span class="line"><span class="params">			TypeA first, TypeB second)</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Pair</span>&lt;TypeA, TypeB&gt;(first, second);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;[&quot;</span> + left.toString() + <span class="string">&quot;,&quot;</span> + right.toString() + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Pair&lt;TypeA, TypeB&gt; p)</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.left.equals(p.left) &amp;&amp; <span class="built_in">this</span>.right.equals(p.right);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Pair&lt;TypeA, TypeB&gt; p)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">this</span>.left.equals(p.left))</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">this</span>.right.compareTo(p.right);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.left.compareTo(p.left);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>另一种比较器写法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pair_Comp</span>&lt;TypeA <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;TypeA&gt;, TypeB <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;TypeB&gt;&gt;</span><br><span class="line">		<span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;Pair&lt;TypeA, TypeB&gt;&gt; &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Pair&lt;TypeA, TypeB&gt; p1, Pair&lt;TypeA, TypeB&gt; p2)</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> p1.compareTo(p2);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Queue-队列"><a href="#Queue-队列" class="headerlink" title="Queue 队列"></a>Queue 队列</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Queue&lt;integer&gt; que = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;integer&gt;();</span><br></pre></td></tr></table></figure>

<p>用法详见SPFA等应用。</p>
<h2 id="Priority-Queue-优先队列"><a href="#Priority-Queue-优先队列" class="headerlink" title="Priority Queue 优先队列"></a>Priority Queue 优先队列</h2><ul>
<li>It is not recommended to use,for the constructor with the parameter of a comparator is supported since jdk 1.8.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Queue&lt;Integer&gt; que = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;Integer&gt;();</span><br></pre></td></tr></table></figure>


<h2 id="Heap-堆"><a href="#Heap-堆" class="headerlink" title="Heap 堆"></a>Heap 堆</h2><p>This is a minimum heap:<br>这是一个小根堆：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Heap</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> maxn;</span><br><span class="line">    <span class="type">int</span>[] data;</span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line"> </span><br><span class="line">    Heap(<span class="type">int</span> size) &#123;</span><br><span class="line">        maxn=size;</span><br><span class="line">        data = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">        r = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//Arrays.fill(data, 0);</span></span><br><span class="line">        r=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> data[a];</span><br><span class="line">        data[a] = data[b];</span><br><span class="line">        data[b] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">up</span><span class="params">(<span class="type">int</span> p)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(p &gt; <span class="number">0</span>))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">q</span> <span class="operator">=</span> p &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (data[p] &lt; data[q]) &#123;</span><br><span class="line">            swap(p, q);</span><br><span class="line">            up(q);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">down</span><span class="params">(<span class="type">int</span> p)</span> &#123;</span><br><span class="line">        <span class="type">int</span> q;</span><br><span class="line">        <span class="keyword">if</span> ((p &lt;&lt; <span class="number">1</span>) &gt;= r)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((p &lt;&lt; <span class="number">1</span>) == r - <span class="number">1</span>) &#123;</span><br><span class="line">            q = p &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            q = (data[p &lt;&lt; <span class="number">1</span>] &lt; data[p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] ? p &lt;&lt; <span class="number">1</span> : p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (data[p] &gt; data[q]) &#123;</span><br><span class="line">            swap(p, q);</span><br><span class="line">            down(q);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        data[r++] = n;</span><br><span class="line">        up(r - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> data[<span class="number">0</span>];</span><br><span class="line">        swap(<span class="number">0</span>, r - <span class="number">1</span>);</span><br><span class="line">        r--;</span><br><span class="line">        down(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Directional-edge-有向边"><a href="#Directional-edge-有向边" class="headerlink" title="Directional edge 有向边"></a>Directional edge 有向边</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">	<span class="type">int</span> v, f, w, nx;</span><br><span class="line"></span><br><span class="line">	Edge() &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Edge(<span class="type">int</span> _v, <span class="type">int</span> _f, <span class="type">int</span> _w, <span class="type">int</span> _nx) &#123;</span><br><span class="line">		modify(_v, _f, _w, _nx);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">modify</span><span class="params">(<span class="type">int</span> _v, <span class="type">int</span> _f, <span class="type">int</span> _w, <span class="type">int</span> _nx)</span> &#123;</span><br><span class="line">		v = _v;</span><br><span class="line">		f = _f;</span><br><span class="line">		w = _w;</span><br><span class="line">		nx = _nx;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Arc-弧"><a href="#Arc-弧" class="headerlink" title="Arc 弧"></a>Arc 弧</h2><p>适用于网络流模型中的有向边。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">	<span class="type">int</span> to, cap, flow, next;</span><br><span class="line"></span><br><span class="line">	Edge() &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Edge(<span class="type">int</span> _v, <span class="type">int</span> _f, <span class="type">int</span> _w, <span class="type">int</span> _nx) &#123;</span><br><span class="line">		modify(_v, _f, _w, _nx);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">modify</span><span class="params">(<span class="type">int</span> _v, <span class="type">int</span> _f, <span class="type">int</span> _w, <span class="type">int</span> _nx)</span> &#123;</span><br><span class="line">		to = _v;	cap = _f;	flow = _w;	next = _nx;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


<h2 id="Adjacent-Table-链式前向星（邻接表）"><a href="#Adjacent-Table-链式前向星（邻接表）" class="headerlink" title="Adjacent Table 链式前向星（邻接表）"></a>Adjacent Table 链式前向星（邻接表）</h2><p>避免重复分配内存空间设计。<br><code>addEdge</code>根据具体需求修改。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Graph</span> &#123;</span><br><span class="line">	<span class="type">int</span>[] h;</span><br><span class="line">	<span class="type">int</span> maxn, maxm;</span><br><span class="line">	Edge[] e;</span><br><span class="line">	<span class="type">int</span> num;</span><br><span class="line"></span><br><span class="line">	Graph(<span class="type">int</span> _n, <span class="type">int</span> _m) &#123;</span><br><span class="line">		maxn = _n;</span><br><span class="line">		maxm = _m;</span><br><span class="line">		h = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">		e = <span class="keyword">new</span> <span class="title class_">Edge</span>[maxm];</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxm; i++)</span><br><span class="line">			e[i] = <span class="keyword">new</span> <span class="title class_">Edge</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">		Arrays.fill(h, -<span class="number">1</span>);</span><br><span class="line">		num = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> f, <span class="type">int</span> w)</span> &#123;</span><br><span class="line">		e[num].modify(v, f, w, h[u]);</span><br><span class="line">		h[u] = num++;</span><br><span class="line">		e[num].modify(u, <span class="number">0</span>, -w, h[v]);</span><br><span class="line">		h[v] = num++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ST-table-ST表"><a href="#ST-table-ST表" class="headerlink" title="ST table ST表"></a>ST table ST表</h2><p>RMQ 区间最值查询（静态，离线）  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">RMQ</span><span class="params">()</span>&#123; <span class="comment">//initializing-&gt;O(nlogn)&#123;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i != maxm; ++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            <span class="keyword">if</span>(j + (<span class="number">1</span> &lt;&lt; i) - <span class="number">1</span> &lt;= n)&#123;</span><br><span class="line">                maxsum[i][j] = Math.max(maxsum[i - <span class="number">1</span>][j], </span><br><span class="line">                            maxsum[i - <span class="number">1</span>][j + (<span class="number">1</span> &lt;&lt; i &gt;&gt; <span class="number">1</span>)]);</span><br><span class="line">                minsum[i][j] = Math.min(minsum[i - <span class="number">1</span>][j], </span><br><span class="line">                            minsum[i - <span class="number">1</span>][j + (<span class="number">1</span> &lt;&lt; i &gt;&gt; <span class="number">1</span>)]);</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line"><span class="type">int</span> <span class="title function_">query</span><span class="params">(<span class="type">int</span> src,<span class="type">int</span> des)</span>&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> (<span class="type">int</span>)(Math.log(des - src + <span class="number">1.0</span>) / Math.log(<span class="number">2.0</span>));</span><br><span class="line">        <span class="type">int</span> <span class="variable">maxres</span> <span class="operator">=</span> Math.max(maxsum[k][src], </span><br><span class="line">                          maxsum[k][des - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>]);</span><br><span class="line">        <span class="type">int</span> <span class="variable">minres</span> <span class="operator">=</span> Math.min(minsum[k][src], </span><br><span class="line">                          minsum[k][des - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">return</span> maxres-minres;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Segment-Tree-线段树"><a href="#Segment-Tree-线段树" class="headerlink" title="Segment Tree 线段树"></a>Segment Tree 线段树</h2><p>单点更新，区间求和。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SegTree</span> &#123;</span><br><span class="line">    <span class="type">int</span> l, r, m;</span><br><span class="line">    <span class="type">long</span> val;</span><br><span class="line">    SegTree L, R;</span><br><span class="line"></span><br><span class="line">    SegTree() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    SegTree(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">        build(x, y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">build</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mi</span> <span class="operator">=</span> (x + y) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        l = x;</span><br><span class="line">        r = y;</span><br><span class="line">        m = mi;</span><br><span class="line">        val = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; y) &#123;</span><br><span class="line">            <span class="keyword">if</span> (L == <span class="literal">null</span>)</span><br><span class="line">                L = <span class="keyword">new</span> <span class="title class_">SegTree</span>(x, m);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                L.build(x, m);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (R == <span class="literal">null</span>)</span><br><span class="line">                R = <span class="keyword">new</span> <span class="title class_">SegTree</span>(m + <span class="number">1</span>, y);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                R.build(m + <span class="number">1</span>, y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">up</span><span class="params">()</span> &#123;</span><br><span class="line">        val = L.val + R.val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            val += v;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x &lt;= m)</span><br><span class="line">            L.add(x, v);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x &gt; m)</span><br><span class="line">            R.add(x, v);</span><br><span class="line">        up();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">long</span> <span class="title function_">query</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt;= l &amp;&amp; r &lt;= y) &#123;</span><br><span class="line">            <span class="keyword">return</span> val;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (x &lt;= m)</span><br><span class="line">            res += L.query(x, y);</span><br><span class="line">        <span class="keyword">if</span> (y &gt; m)</span><br><span class="line">            res += R.query(x, y);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Binary-Indexed-Tree-树状数组"><a href="#Binary-Indexed-Tree-树状数组" class="headerlink" title="Binary Indexed Tree 树状数组"></a>Binary Indexed Tree 树状数组</h2><p>Suppose there are n distinct integers ranging from $ 1$ to $ n$,and the $ k$th largest one is required(use <code>query(k-1)</code>).<br>假设有范围在 $ [1,n]$内的 $ n$个不同整数，求第 $ k$大的数（调用<code>query(k-1)</code>）。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BIT</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] data;</span><br><span class="line">    <span class="type">int</span> sz;</span><br><span class="line"></span><br><span class="line">    BIT() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    BIT(<span class="type">int</span> _sz) &#123;</span><br><span class="line">        sz = _sz;</span><br><span class="line">        data = <span class="keyword">new</span> <span class="title class_">int</span>[sz + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">lowbit</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x &amp; (-x);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (p &lt;= sz) &#123;</span><br><span class="line">            data[p] += v;</span><br><span class="line">            p += lowbit(p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">sum</span><span class="params">(<span class="type">int</span> p)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (p &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            res += data[p];</span><br><span class="line">            p -= lowbit(p);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">find</span><span class="params">(<span class="type">int</span> p)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> <span class="number">1</span>, r = sz;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (sum(mid) &lt;= p)</span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                r = mid;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Graph-Theory-图论篇"><a href="#Graph-Theory-图论篇" class="headerlink" title="Graph Theory 图论篇"></a>Graph Theory 图论篇</h1><h2 id="Topological-Sorting-拓扑排序"><a href="#Topological-Sorting-拓扑排序" class="headerlink" title="Topological Sorting 拓扑排序"></a>Topological Sorting 拓扑排序</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] degree;</span><br><span class="line"><span class="type">boolean</span>[][] arc;</span><br><span class="line">Vector&lt;Integer&gt; ans;</span><br><span class="line">PriorityQueue&lt;Integer&gt; que;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">Topo</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> <span class="number">1</span>; u &lt;= n; u++)</span><br><span class="line">            <span class="keyword">if</span> (degree[u] == <span class="number">0</span>) &#123;</span><br><span class="line">                que.add(u);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> que.poll();</span><br><span class="line">            ans.add(u);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> <span class="number">1</span>; v &lt;= n; v++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (arc[u][v]) &#123;</span><br><span class="line">                    degree[v]--;</span><br><span class="line">                    <span class="keyword">if</span> (degree[v] == <span class="number">0</span>) &#123;</span><br><span class="line">                        que.add(v);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Hungarian-Algorithm-二分图最大匹配-匈牙利算法"><a href="#Hungarian-Algorithm-二分图最大匹配-匈牙利算法" class="headerlink" title="Hungarian Algorithm 二分图最大匹配 - 匈牙利算法"></a>Hungarian Algorithm 二分图最大匹配 - 匈牙利算法</h2><p>先初始化，再通过<code>init</code>执行清理。<br>输入左点与右点个数之和与连接左点、右点之边，求最大匹配数。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Hungary</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> n, maxn;</span><br><span class="line">	<span class="keyword">private</span> Vector&lt;Integer&gt;[] vec;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span>[] match;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">boolean</span>[] vis;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Hungary</span><span class="params">(<span class="type">int</span> _n)</span> &#123;</span><br><span class="line">		maxn = _n;</span><br><span class="line">		vec = <span class="keyword">new</span> <span class="title class_">Vector</span>[maxn];</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxn; i++)</span><br><span class="line">			vec[i] = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;Integer&gt;();</span><br><span class="line">		match = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">		vis = <span class="keyword">new</span> <span class="title class_">boolean</span>[maxn];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">init</span><span class="params">(<span class="type">int</span> _n)</span> &#123;</span><br><span class="line">		n = _n;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">			vec[i].clear();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> &#123;</span><br><span class="line">		vec[u].add(v);</span><br><span class="line">		vec[v].add(u);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">boolean</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> v)</span> &#123;</span><br><span class="line">		vis[v] = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; vec[v].size(); i++) &#123;</span><br><span class="line">			<span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> vec[v].get(i);</span><br><span class="line">			<span class="type">int</span> <span class="variable">w</span> <span class="operator">=</span> match[u];</span><br><span class="line">			<span class="keyword">if</span> (w &lt; <span class="number">0</span> || !vis[w] &amp;&amp; dfs(w)) &#123;</span><br><span class="line">				match[v] = u;</span><br><span class="line">				match[u] = v;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> <span class="title function_">matching</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		Arrays.fill(match, -<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">			<span class="keyword">if</span> (match[i] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">				Arrays.fill(vis, <span class="literal">false</span>);</span><br><span class="line">				<span class="keyword">if</span> (dfs(i))</span><br><span class="line">					res++;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Hopcroft-Karp-Algorithm-二分图最大匹配-HK算法"><a href="#Hopcroft-Karp-Algorithm-二分图最大匹配-HK算法" class="headerlink" title="Hopcroft-Karp Algorithm 二分图最大匹配 - HK算法"></a>Hopcroft-Karp Algorithm 二分图最大匹配 - HK算法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">HK</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> <span class="variable">inf</span> <span class="operator">=</span> <span class="number">0x3fffffff</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> n, n1, n2, maxn;</span><br><span class="line">	<span class="keyword">private</span> Vector&lt;Integer&gt;[] vec;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span>[] mx, my, dx, dy;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">boolean</span>[] vis;</span><br><span class="line">	<span class="keyword">private</span> Queue&lt;Integer&gt; que;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> dis;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">HK</span><span class="params">(<span class="type">int</span> _n)</span> &#123;</span><br><span class="line">		maxn = _n;</span><br><span class="line">		vec = <span class="keyword">new</span> <span class="title class_">Vector</span>[maxn];</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxn; i++)</span><br><span class="line">			vec[i] = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;Integer&gt;();</span><br><span class="line">		mx = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">		my = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">		vis = <span class="keyword">new</span> <span class="title class_">boolean</span>[maxn];</span><br><span class="line">		que = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;Integer&gt;();</span><br><span class="line">		dx = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">		dy = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">init</span><span class="params">(<span class="type">int</span> _n, <span class="type">int</span> _n1, <span class="type">int</span> _n2)</span> &#123;</span><br><span class="line">		n = _n;	n1 = _n1;	n2 = _n2;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">			vec[i].clear();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> &#123;</span><br><span class="line">		vec[u].add(v);</span><br><span class="line">		vec[v].add(u);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">boolean</span> <span class="title function_">searchpath</span><span class="params">()</span> &#123;</span><br><span class="line">		que.clear();</span><br><span class="line">		dis = inf;</span><br><span class="line">		Arrays.fill(dx, -<span class="number">1</span>);</span><br><span class="line">		Arrays.fill(dy, -<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n1; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (mx[i] == -<span class="number">1</span>) &#123;</span><br><span class="line">				que.add(i);</span><br><span class="line">				dx[i] = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">			<span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> que.poll();</span><br><span class="line">			<span class="keyword">if</span> (dx[u] &gt; dis)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; vec[u].size(); i++) &#123;</span><br><span class="line">				<span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> vec[u].get(i);</span><br><span class="line">				<span class="keyword">if</span> (dy[v] == -<span class="number">1</span>) &#123;</span><br><span class="line">					dy[v] = dx[u] + <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">if</span> (my[v] == -<span class="number">1</span>)</span><br><span class="line">						dis = dy[v];</span><br><span class="line">					<span class="keyword">else</span> &#123;</span><br><span class="line">						dx[my[v]] = dy[v] + <span class="number">1</span>;</span><br><span class="line">						que.add(my[v]);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> dis != inf;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">boolean</span> <span class="title function_">findpath</span><span class="params">(<span class="type">int</span> u)</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; vec[u].size(); i++) &#123;</span><br><span class="line">			<span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> vec[u].get(i);</span><br><span class="line">			<span class="keyword">if</span> (!vis[v] &amp;&amp; dy[v] == dx[u] + <span class="number">1</span>) &#123;</span><br><span class="line">				vis[v] = <span class="literal">true</span>;</span><br><span class="line">				<span class="keyword">if</span> (my[v] != -<span class="number">1</span> &amp;&amp; dy[v] == dis)</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span> (my[v] == -<span class="number">1</span> || findpath(my[v])) &#123;</span><br><span class="line">					my[v] = u;</span><br><span class="line">					mx[u] = v;</span><br><span class="line">					<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> <span class="title function_">maxmatch</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		Arrays.fill(mx, -<span class="number">1</span>);</span><br><span class="line">		Arrays.fill(my, -<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">while</span> (searchpath()) &#123;</span><br><span class="line">			Arrays.fill(vis, <span class="literal">false</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n1; i++)</span><br><span class="line">				<span class="keyword">if</span> (mx[i] == -<span class="number">1</span>)</span><br><span class="line">					res += findpath(i) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="SPFA最短路径"><a href="#SPFA最短路径" class="headerlink" title="SPFA最短路径"></a>SPFA最短路径</h2><p>先通过构造函数初始化，再通过<code>init</code>执行清理。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">spfa</span> &#123;</span><br><span class="line">	<span class="keyword">final</span> <span class="type">int</span> <span class="variable">inf</span> <span class="operator">=</span> <span class="number">0x3fffffff</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> maxn, maxm, src;</span><br><span class="line">	<span class="keyword">public</span> Graph g;</span><br><span class="line">	<span class="keyword">private</span> Queue&lt;Integer&gt; que;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">boolean</span>[] inQue;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span>[] dis;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span>[] prev, pree;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">spfa</span><span class="params">(<span class="type">int</span> _n, <span class="type">int</span> _m)</span> &#123;</span><br><span class="line">		maxn = _n;</span><br><span class="line">		maxm = _m;</span><br><span class="line">		dis = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">		inQue = <span class="keyword">new</span> <span class="title class_">boolean</span>[maxn];</span><br><span class="line">		prev = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">		pree = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">		que = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;Integer&gt;();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">init</span><span class="params">(Graph _g, <span class="type">int</span> _u)</span> &#123;</span><br><span class="line">		g = _g;</span><br><span class="line">		src = _u;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">init</span><span class="params">(<span class="type">int</span> _u)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (g == <span class="literal">null</span>)</span><br><span class="line">			g = <span class="keyword">new</span> <span class="title class_">Graph</span>(maxn, maxm);</span><br><span class="line">		g.init();</span><br><span class="line">		src = _u;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> f, <span class="type">int</span> w)</span> &#123;</span><br><span class="line">		g.addEdge(u, v, f, w);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">solve</span><span class="params">()</span> &#123;</span><br><span class="line">		que.clear();</span><br><span class="line">		que.add(src);</span><br><span class="line">		Arrays.fill(dis, inf);</span><br><span class="line">		dis[src] = <span class="number">0</span>;</span><br><span class="line">		inQue[src] = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">			<span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> que.poll();</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> g.h[u]; i != -<span class="number">1</span>; i = g.e[i].nx) &#123;</span><br><span class="line">				<span class="keyword">if</span> (g.e[i].f &gt; <span class="number">0</span> &amp;&amp; dis[u] + g.e[i].w &lt; dis[g.e[i].v]) &#123;</span><br><span class="line">					dis[g.e[i].v] = dis[u] + g.e[i].w;</span><br><span class="line">					prev[g.e[i].v] = u;</span><br><span class="line">					pree[g.e[i].v] = i;</span><br><span class="line">					<span class="keyword">if</span> (!inQue[g.e[i].v]) &#123;</span><br><span class="line">						inQue[g.e[i].v] = <span class="literal">true</span>;</span><br><span class="line">						que.add(g.e[i].v);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			inQue[u] = <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> <span class="title function_">get_res</span><span class="params">(<span class="type">int</span> v)</span> &#123;</span><br><span class="line">		solve();</span><br><span class="line">		<span class="keyword">return</span> dis[v];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Number-Theory-数论篇"><a href="#Number-Theory-数论篇" class="headerlink" title="Number Theory 数论篇"></a>Number Theory 数论篇</h1><h2 id="Extended-Euclid-Theorem-扩展欧几里得定理"><a href="#Extended-Euclid-Theorem-扩展欧几里得定理" class="headerlink" title="Extended Euclid Theorem 扩展欧几里得定理"></a>Extended Euclid Theorem 扩展欧几里得定理</h2><p>Suppose $ ax+by&#x3D;gcd(a,b) $,and the value of $ x $ and of $ y $ are required.<br>已知 $ ax+by&#x3D;gcd(a,b) $，求 $ x$与 $ y$的值。<br>注意 $ x$与 $ y$中很可能有一个是负整数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> x,y;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">extgcd</span><span class="params">(<span class="type">long</span> a, <span class="type">long</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="number">0L</span>) &#123;</span><br><span class="line">            x = <span class="number">1L</span>;</span><br><span class="line">            y = <span class="number">0L</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        extgcd(b, a % b);</span><br><span class="line">        <span class="type">long</span> <span class="variable">t</span> <span class="operator">=</span> x;</span><br><span class="line">        x = y;</span><br><span class="line">        y = t - a / b * y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Modular-multiplicative-inverse-模逆元"><a href="#Modular-multiplicative-inverse-模逆元" class="headerlink" title="Modular multiplicative inverse 模逆元"></a>Modular multiplicative inverse 模逆元</h2><p> $ a^{-1} \equiv b \pmod{n},a \cdot a^{-1} \equiv 1 $.<br>The modular multiplicative inverse of $ a $ modulo $ m $ can be found with the extended Euclidean algorithm.<br>设<code>exdgcd(a,n)</code>为扩展欧几里得算法的函数，则可得到 $ ax+ny&#x3D;gcd(a,n)$.<br>若 $ g&#x3D;1$，则该模逆元存在，根据结果 $ ax+ny&#x3D;1$.<br>在 $ \mod{n}$之下， $ ax+ny \equiv ax \equiv 1 $，根据模逆元的定义，此时$ x$即为$ a$关于模$ n$的其中一个模逆元。<br>事实上， $ x+kn(k \in \mathbb{Z}) $都是 $ a$关于模 $ n$的模逆元，这里取最小的正整数解 $ x\mod{n} (x \lt n) $。<br>若 $ g\ne 1$，则该模逆元不存在。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">cal_inv</span><span class="params">(<span class="type">long</span> n, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        extgcd(n, mod);</span><br><span class="line">        <span class="keyword">return</span> x &lt; <span class="number">0L</span> ? (x + mod) % mod : x % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>According to Euler’s theorem, if $ a$ is coprime to $ m$, that is, $ gcd(a, m) &#x3D; 1$, then $ a^φ(m)≡1\pmod{m}$,where $ φ(m)$ is Euler’s totient function.<br> $ a^{φ(m)-1}≡a^{-1}\pmod{m}$.<br>In the special case when $ m$ is a prime, the modular inverse is given by the below equation as: $ a^{-1}≡a^{m-2}\pmod{m}$.<br>欧拉函数求单个逆元：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">cal_inv</span><span class="params">(<span class="type">long</span> n, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> pow_mod(n, phi[mod] - <span class="number">1</span>, mod);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过递推的方式，在线性时间复杂度内求出若干个逆元：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">cal_inv</span><span class="params">(<span class="type">int</span> maxn, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt; maxn; i++)</span><br><span class="line">            inv[i] = (mod - mod / i) * inv[(<span class="type">int</span>) (mod % i)] % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Quick-power-and-modulo-快速幂取模"><a href="#Quick-power-and-modulo-快速幂取模" class="headerlink" title="Quick power and modulo 快速幂取模"></a>Quick power and modulo 快速幂取模</h2><p>To calculate $ n^m%mod $:<br>计算 $ n^m%mod $：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">pow_mod</span><span class="params">(<span class="type">long</span> n, <span class="type">long</span> m, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">        n %= mod;</span><br><span class="line">        <span class="keyword">while</span> (m &gt; <span class="number">0L</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((m &amp; <span class="number">1L</span>) &gt; <span class="number">0L</span>)</span><br><span class="line">                res = res * n % mod;</span><br><span class="line">            n = n * n % mod;</span><br><span class="line">            m &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Multiply-and-modulo-乘法取模"><a href="#Multiply-and-modulo-乘法取模" class="headerlink" title="Multiply and modulo 乘法取模"></a>Multiply and modulo 乘法取模</h2><p>To calculate $ nm%mod $:<br>在$ n $和$ m $的值都较大，直接相乘会溢出的情况下，计算 $ nm%mod $：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">mul_mod</span><span class="params">(<span class="type">long</span> n, <span class="type">long</span> m, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br><span class="line">        n %= mod;</span><br><span class="line">        <span class="keyword">while</span> (m &gt; <span class="number">0L</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((m &amp; <span class="number">1L</span>) &gt; <span class="number">0L</span>)</span><br><span class="line">                ans = (ans + n) % mod;</span><br><span class="line">            m &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">            n = (n + n) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Division-and-modulo-除法取模"><a href="#Division-and-modulo-除法取模" class="headerlink" title="Division and modulo 除法取模"></a>Division and modulo 除法取模</h2><p>To calculate $ n&#x2F;m%mod $ correctly ( $ mod$ is a prime number thus $ φ(mod)&#x3D;mod-1 $).<br>利用欧拉函数计算 $ n&#x2F;m%mod $（当 $ mod$是一个质数时有 $ φ(mod)&#x3D;mod-1 $）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">div_mod</span><span class="params">(<span class="type">long</span> n, <span class="type">long</span> m, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> n * pow_mod(m, mod - <span class="number">2</span>, mod) % mod;</span><br><span class="line">        <span class="comment">// return n * pow_mod(m, phi(mod) - 1, mod) % mod;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In other words,use modular multiplicative inverse.<br>或者直接使用模逆元：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">div_mod</span><span class="params">(<span class="type">long</span> n, <span class="type">long</span> m, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> n * inv[(<span class="type">int</span>) m] % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Factorial-and-modulo-阶乘取模"><a href="#Factorial-and-modulo-阶乘取模" class="headerlink" title="Factorial and modulo 阶乘取模"></a>Factorial and modulo 阶乘取模</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">Get_Fac</span><span class="params">(<span class="type">long</span> n, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            fac[i] = fac[i - <span class="number">1</span>] * i;</span><br><span class="line">            fac[i] %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Prime-filtering-linear-线性筛质数"><a href="#Prime-filtering-linear-线性筛质数" class="headerlink" title="Prime filtering (linear) 线性筛质数"></a>Prime filtering (linear) 线性筛质数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] pri,fstp;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">filter_prime</span><span class="params">()</span>&#123;</span><br><span class="line">        pri=<span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">        fstp=<span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;maxn;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (fstp[i]==<span class="number">0</span>)&#123;</span><br><span class="line">                pri[++pri[<span class="number">0</span>]]=i;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=pri[<span class="number">0</span>]&amp;&amp;i*pri[j]&lt;maxn;j++)&#123;</span><br><span class="line">                <span class="type">int</span> k=i*pri[j];</span><br><span class="line">                fstp[k]=pri[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Calculating-Euler-function-φ-n-求欧拉函数值"><a href="#Calculating-Euler-function-φ-n-求欧拉函数值" class="headerlink" title="Calculating Euler function $ φ(n) $ 求欧拉函数值"></a>Calculating Euler function $ φ(n) $ 求欧拉函数值</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] pri,phi,fstp;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">cal_euler</span><span class="params">()</span>&#123;</span><br><span class="line">        pri=<span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">        fstp=<span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">        phi=<span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">        phi[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;maxn;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (fstp[i]==<span class="number">0</span>)&#123;</span><br><span class="line">                pri[++pri[<span class="number">0</span>]]=i;</span><br><span class="line">                phi[i]=i-<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=pri[<span class="number">0</span>]&amp;&amp;i*pri[j]&lt;maxn;j++)&#123;</span><br><span class="line">                <span class="type">int</span> k=i*pri[j];</span><br><span class="line">                fstp[k]=pri[j];</span><br><span class="line">                <span class="keyword">if</span> (i%pri[j]==<span class="number">0</span>)&#123;</span><br><span class="line">                    phi[k]=phi[i]*pri[j];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    phi[k]=phi[i]*(pri[j]-<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Calculating-Mobius-function-μ-n-求莫比乌斯函数值"><a href="#Calculating-Mobius-function-μ-n-求莫比乌斯函数值" class="headerlink" title="Calculating Möbius function $ μ(n) $ 求莫比乌斯函数值"></a>Calculating Möbius function $ μ(n) $ 求莫比乌斯函数值</h2><p>莫比乌斯函数$ μ(d) $的定义如下：  </p>
<ul>
<li>若$ d&#x3D;1 $，那么$ μ(d)&#x3D;1 $；  </li>
<li>若$ d&#x3D;p_1p_2…p_k $($ p_1…p_k $均为互异质数)，那么$ μ(d)&#x3D;(−1)^k $；  </li>
<li>其他情况下，$ μ(d)&#x3D;0 $.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] pri,fstp,miu;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">cal_euler</span><span class="params">()</span>&#123;</span><br><span class="line">        pri=<span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">        fstp=<span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">        miu=<span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">        miu[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;maxn;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (fstp[i]==<span class="number">0</span>)&#123;</span><br><span class="line">                pri[++pri[<span class="number">0</span>]]=i;</span><br><span class="line">                miu[i]=-<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=pri[<span class="number">0</span>]&amp;&amp;i*pri[j]&lt;maxn;j++)&#123;</span><br><span class="line">                <span class="type">int</span> k=i*pri[j];</span><br><span class="line">                fstp[k]=pri[j];</span><br><span class="line">                <span class="keyword">if</span> (i%pri[j]==<span class="number">0</span>)&#123;</span><br><span class="line">                    miu[k]=<span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    miu[k]=-miu[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Integer-Prime-Factorization-分解质因数"><a href="#Integer-Prime-Factorization-分解质因数" class="headerlink" title="Integer Prime Factorization 分解质因数"></a>Integer Prime Factorization 分解质因数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Vector&lt;Integer&gt; <span class="title function_">get_prime_factor</span><span class="params">(<span class="type">int</span> n)</span>&#123;</span><br><span class="line">        Vector&lt;Integer&gt; res=<span class="keyword">new</span> <span class="title class_">Vector</span>&lt;Integer&gt;();</span><br><span class="line">        res.clear();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i*i&lt;=n;i++)</span><br><span class="line">            <span class="keyword">if</span> (n%i==<span class="number">0</span>)&#123;</span><br><span class="line">                res.add(i);</span><br><span class="line">                <span class="keyword">while</span>(n%i==<span class="number">0</span>)</span><br><span class="line">                    n/=i;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">if</span> (n&gt;<span class="number">1</span>) res.add(n);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Quick-Greatest-Common-Divisor-快速求最大公约数"><a href="#Quick-Greatest-Common-Divisor-快速求最大公约数" class="headerlink" title="Quick Greatest Common Divisor 快速求最大公约数"></a>Quick Greatest Common Divisor 快速求最大公约数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">kgcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (a == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> b;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> a;</span><br><span class="line">        <span class="keyword">if</span> ((a &amp; <span class="number">1</span>) == <span class="number">0</span> &amp;&amp; (b &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> kgcd(a &gt;&gt; <span class="number">1</span>, b &gt;&gt; <span class="number">1</span>) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((b &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> kgcd(a, b &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((a &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> kgcd(a &gt;&gt; <span class="number">1</span>, b);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> kgcd(Math.abs(a - b), Math.min(a, b));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Chinese-Remainer-Theorem-中国剩余定理"><a href="#Chinese-Remainer-Theorem-中国剩余定理" class="headerlink" title="Chinese Remainer Theorem 中国剩余定理"></a>Chinese Remainer Theorem 中国剩余定理</h2><p>Resolving $ \begin{cases} x ≡a_1 \pmod{m_1}, \newline x ≡a_2 \pmod{m_2}, \newline …, \newline x ≡a_n \pmod{m_n}. \end{cases} $.<br>解同余方程组 $ \begin{cases} x ≡a_1 \pmod{m_1}, \newline x ≡a_2 \pmod{m_2}, \newline …, \newline x ≡a_n \pmod{m_n}. \end{cases} $。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">CRT</span><span class="params">(<span class="type">long</span> n, <span class="type">long</span>[] a, <span class="type">long</span>[] m)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">pro</span> <span class="operator">=</span> <span class="number">1L</span>, res = <span class="number">0L</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            pro *= m[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">w</span> <span class="operator">=</span> pro / m[i];</span><br><span class="line">            extgcd(m[i], w);</span><br><span class="line">            res = (res + mul_mod(y, mul_mod(w, a[i], pro), pro)) % pro;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (res + pro) % pro;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Combinatorial-Mathematics-组合数学篇"><a href="#Combinatorial-Mathematics-组合数学篇" class="headerlink" title="Combinatorial Mathematics 组合数学篇"></a>Combinatorial Mathematics 组合数学篇</h1><h2 id="Combination-Calculation-1-组合数计算1"><a href="#Combination-Calculation-1-组合数计算1" class="headerlink" title="Combination Calculation #1 组合数计算1"></a>Combination Calculation #1 组合数计算1</h2><p> $ C_n^m&#x3D;C_{n-1}^m+C_{n-1}^{m-1}$.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span>[][] c;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">        c=<span class="keyword">new</span> <span class="title class_">double</span>[maxn][maxn];</span><br><span class="line">        c[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;maxn;i++)&#123;</span><br><span class="line">            c[i][<span class="number">0</span>]=c[i][i]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;i;j++)</span><br><span class="line">                c[i][j]=c[i-<span class="number">1</span>][j]+c[i-<span class="number">1</span>][j-<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Combination-Calculation-2-组合数计算2"><a href="#Combination-Calculation-2-组合数计算2" class="headerlink" title="Combination Calculation #2 组合数计算2"></a>Combination Calculation #2 组合数计算2</h2><p>It is guaranteed that $ n≥m$,but $ n!$ should be computed in advance.<br>在 $ n≥m$且 $ n!$已求出的前提下，单个计算 $ C_n^m$：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">C</span><span class="params">(<span class="type">long</span> n, <span class="type">long</span> m, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> (<span class="type">int</span>) (n % mod), b = (<span class="type">int</span>) (m % mod);</span><br><span class="line">        <span class="keyword">return</span> div_mod(fac[a], mul_mod(fac[a - b], fac[b], mod), mod);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Lucas-Theorem-卢卡斯定理"><a href="#Lucas-Theorem-卢卡斯定理" class="headerlink" title="Lucas Theorem 卢卡斯定理"></a>Lucas Theorem 卢卡斯定理</h2><p><code>C(n, m, mod)</code> refers to $ C_n^m%mod $.<br><code>C(n, m, mod)</code>表示 $ C_n^m%mod $。</p>
<p>如果有<br>$ n &#x3D; a_k p^k + a_{k-1} p^{k-1} + … + a_1 p + a_0 $,<br>$ m &#x3D; b_k p^k + b_{k-1} p^{k-1} + … + b_1 p + b_0 $,<br>则$ C_n^m &#x3D; \prod_{i&#x3D;0}^k C_{a_i}^{b_i}%p $.  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">Lucas</span><span class="params">(<span class="type">long</span> n, <span class="type">long</span> m, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">        <span class="keyword">while</span> (n &gt; <span class="number">0L</span> &amp;&amp; m &gt; <span class="number">0L</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (n % mod &lt; m % mod)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0L</span>;</span><br><span class="line">            ret = mul_mod(ret, C(n, m, mod), mod);</span><br><span class="line">            ret %= mod;</span><br><span class="line">            n /= mod;</span><br><span class="line">            m /= mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Catalan-number-卡塔兰数"><a href="#Catalan-number-卡塔兰数" class="headerlink" title="Catalan number 卡塔兰数"></a>Catalan number 卡塔兰数</h2><p> $ C_n &#x3D; {2n\choose n} - {2n\choose n+1} &#x3D; {1\over n+1}{2n\choose n} \quad\text{ for }n\ge 0$;<br>The Catalan numbers satisfy the recurrence relation $ C_0 &#x3D; 1 \quad $ and $ \quad C_{n+1}&#x3D;\sum_{i&#x3D;0}^{n}C_i,C_{n-i}\quad\text{for }n\ge 0 $;<br>moreover, $ C_n&#x3D; \frac 1{n+1} \sum_{i&#x3D;0}^n {n \choose i}^2$.<br>Asymptotically, the Catalan numbers grow as $ C_n \sim \frac{4^n}{n^{3&#x2F;2}\sqrt{\pi}}$.<br>组合数学中有非常多的组合结构可以用卡塔兰数来计数。</p>
<ul>
<li>$ C_n$表示长度2n的dyck word的个数。Dyck word是一个有n个X和n个Y组成的字串，且所有的前缀字串皆满足X的个数大于等于Y的个数。以下为长度为6的dyck words:XXXYYY XYXXYY XYXYXY XXYYXY XXYXYY </li>
<li>将上例的X换成左括号，Y换成右括号， $ C_n$表示所有包含n组括号的合法运算式的个数：((())) ()(()) ()()() (())() (()()) </li>
<li>$ C_n$表示有n个节点组成不同构二叉树的方案数。 </li>
<li>$ C_n$表示有2n+1个节点组成不同构满二叉树（full binary tree）的方案数。</li>
</ul>
<blockquote>
<p>证明：<br>令1表示进栈，0表示出栈，则可转化为求一个2n位、含n个1、n个0的二进制数，满足从左往右扫描到任意一位时，经过的0数不多于1数。显然含n个1、n个0的2n位二进制数共有 $ {2n \choose n}$个，下面考虑不满足要求的数目。<br>考虑一个含n个1、n个0的2n位二进制数，扫描到第2m+1位上时有m+1个0和m个1（容易证明一定存在这样的情况），则后面的0-1排列中必有n-m个1和n-m-1个0。将2m+2及其以后的部分0变成1、1变成0，则对应一个n+1个0和n-1个1的二进制数。反之亦然（相似的思路证明两者一一对应）。<br>从而 $ C_n &#x3D; {2n \choose n} - {2n \choose n + 1} &#x3D; \frac{1}{n+1}{2n \choose n}$。证毕。</p>
</blockquote>
<ul>
<li>$ C_n$表示所有在n × n格点中不越过对角线的单调路径的个数。一个单调路径从格点左下角出发，在格点右上角结束，每一步均为向上或向右。计算这种路径的个数等价于计算Dyck word的个数：X代表“向右”，Y代表“向上”。</li>
<li>$ C_n$表示通过连结顶点而将n + 2边的凸多边形分成三角形的方法个数。 </li>
<li>$ C_n$表示对{1, …, n}依序进出栈的置换个数。一个置换w是依序进出栈的当S(w) &#x3D; (1, …, n),其中S（w）递归定义如下：令w &#x3D; unv，其中n为w的最大元素，u和v为更短的数列；再令S(w) &#x3D; S(u)S(v)n，其中S为所有含一个元素的数列的单位元。</li>
<li>$ C_n$表示集合{1, …, n}的不交叉划分的个数.那么, Cn永远不大于第n项贝尔数. Cn也表示集合{1, …, 2n}的不交叉划分的个数，其中每个段落的长度为2。</li>
<li>$ C_n$表示用n个长方形填充一个高度为n的阶梯状图形的方法个数。</li>
<li>$ C_n$表示表为2×n的矩阵的标准杨氏矩阵的数量。 也就是说，它是数字 1, 2, …, 2n 被放置在一个2×n的矩形中并保证每行每列的数字升序排列的方案数。同样的，该式可由勾长公式的一个特殊情形推导得出。</li>
</ul>
<p>本例中使用递推公式 $ C_1&#x3D;1,C_n&#x3D;\frac{(4n-2)}{(n+1)} \cdot C_{n-1}$;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> C[];</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">get_Catalan</span><span class="params">(<span class="type">int</span> maxn)</span> &#123;</span><br><span class="line">        C[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt; maxn - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            C[i] = C[i - <span class="number">1</span>] * ((i &lt;&lt; <span class="number">2</span>) - <span class="number">2</span>) % mod;</span><br><span class="line">            C[i] = div_mod(C[i], i + <span class="number">1</span>, mod);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Stirling-numbers-of-the-1st-kind-第一类斯特灵数"><a href="#Stirling-numbers-of-the-1st-kind-第一类斯特灵数" class="headerlink" title="Stirling numbers of the 1st kind 第一类斯特灵数"></a>Stirling numbers of the 1st kind 第一类斯特灵数</h2><p>The Stirling numbers of the first kind are the coefficients in the expansion $ x_{n} &#x3D; \sum_{k&#x3D;0}^n s(n,k) x^k $.<br>where $ x_{n} $ (a Pochhammer symbol) denotes the falling factorial, $ x_{n}&#x3D;x(x-1)(x-2)\cdots(x-n+1) $.<br>第一类Stirling数是有正负的，其绝对值是n个元素的项目分作k个环排列的方法数目。</p>
<ul>
<li><p>给定$ s(n,0)&#x3D;0 $,$ s(1,1)&#x3D;1 $，有递归关系$ s(n,k)&#x3D;s(n-1,k-1) + (n-1) s(n-1,k) $.  </p>
<p>递推关系的说明：考虑第$ n $个物品，$ n $可以单独构成一个非空循环排列，这样前$ n-1 $种物品构成$ k-1 $个非空循环排列，有$ s(n-1,k-1) $种方法；也可以前$ n-1 $种物品构成k个非空循环排列，而第$ n $个物品插入第$ i $个物品的左边，这有$ (n-1)*s(n-1,k) $种方法。</p>
</li>
</ul>
<h2 id="Stirling-numbers-of-the-2nd-kind-第二类斯特灵数"><a href="#Stirling-numbers-of-the-2nd-kind-第二类斯特灵数" class="headerlink" title="Stirling numbers of the 2nd kind 第二类斯特灵数"></a>Stirling numbers of the 2nd kind 第二类斯特灵数</h2><p>第二类Stirling数是n个元素的集定义k个等价类的方法数目。  </p>
<ul>
<li><p>给定$ S(n,n)&#x3D;S(n,1)&#x3D;1 $，有递归关系$ S(n,k) &#x3D; S(n-1,k-1) + k S(n-1,k) $  </p>
<p>递推关系的说明：考虑第n个物品，n可以单独构成一个非空集合，此时前n-1个物品构成k-1个非空的不可辨别的集合，有$ S(n-1,k-1) $种方法；也可以前n-1种物品构成k个非空的不可辨别的集合，第n个物品放入任意一个中，这样有$ k*S(n-1,k) $种方法。  </p>
</li>
<li><p>$ S(n,n-1)&#x3D;C(n,2)&#x3D;n(n-1)&#x2F;2 $  </p>
</li>
<li><p>$ S(n,2)&#x3D;2^{n-1} - 1 $  </p>
</li>
<li><p>$ S(n,k) &#x3D;\frac{1}{k!}\sum_{j&#x3D;1}^{k}(-1)^{k-j} C(k,j) j^n $<br>$ C(k,j) $是二项式系数。</p>
</li>
</ul>
<p>#2-dimensional Computational Geometry 平面计算几何篇<br><code>double pi = Math.acos(-1.0);</code><br><code>double eps = 1e-3;</code></p>
<h2 id="Double-Comparing-实数的比较"><a href="#Double-Comparing-实数的比较" class="headerlink" title="Double Comparing 实数的比较"></a>Double Comparing 实数的比较</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">dcmp</span><span class="params">(<span class="type">double</span> d)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (d &gt; eps ? <span class="number">1</span> : <span class="number">0</span>) - (d &lt; -eps ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Degree-Radian-角度-弧度互化"><a href="#Degree-Radian-角度-弧度互化" class="headerlink" title="Degree&#x2F;Radian 角度&#x2F;弧度互化"></a>Degree&#x2F;Radian 角度&#x2F;弧度互化</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">Rad2Deg</span><span class="params">(<span class="type">double</span> rad)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> rad * <span class="number">180.0</span> / pi;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">double</span> <span class="title function_">Deg2Rad</span><span class="params">(<span class="type">double</span> deg)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> deg * pi / <span class="number">180.0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Point-点"><a href="#Point-点" class="headerlink" title="Point 点"></a>Point 点</h2><h3 id="类定义"><a href="#类定义" class="headerlink" title="类定义"></a>类定义</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">    <span class="type">double</span> x, y;</span><br><span class="line"></span><br><span class="line">    Point() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Point(<span class="type">double</span> _x, <span class="type">double</span> _y) &#123;</span><br><span class="line">        x = _x;</span><br><span class="line">        y = _y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Point(Point p) &#123;</span><br><span class="line">        <span class="built_in">this</span>(p.x, p.y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Comp</span> <span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;Point&gt; &#123;</span><br><span class="line">        Point prep;</span><br><span class="line"></span><br><span class="line">        Comp(Point p) &#123;</span><br><span class="line">            prep = p;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Point a, Point b)</span> &#123;</span><br><span class="line">            <span class="type">double</span> <span class="variable">tmp</span> <span class="operator">=</span> Point.cross(prep, a, b);</span><br><span class="line">            <span class="keyword">if</span> (dcmp(tmp) == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> -dcmp(dist(a, prep) - dist(b, prep));</span><br><span class="line">            <span class="keyword">return</span> -dcmp(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数计算"><a href="#函数计算" class="headerlink" title="函数计算"></a>函数计算</h3><ul>
<li>判断相等</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Point p)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> dcmp(Math.sqrt((x - p.x) * (x - p.x) + (y - p.y) * (y - p.y))) == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>求两点间的欧氏距离</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">dist</span><span class="params">(Point a, Point b)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>两点取中点</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Point <span class="title function_">mid</span><span class="params">(Point a, Point b)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Point</span>((a.x + b.x) / <span class="number">2.0</span>, (a.y + b.y) / <span class="number">2.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Vector-向量"><a href="#Vector-向量" class="headerlink" title="Vector 向量"></a>Vector 向量</h2><h3 id="类定义-1"><a href="#类定义-1" class="headerlink" title="类定义"></a>类定义</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vector</span> <span class="keyword">extends</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">    Vector() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vector(<span class="type">double</span> _x, <span class="type">double</span> _y) &#123;</span><br><span class="line">        x = _x;</span><br><span class="line">        y = _y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vector(Point a, Point b) &#123;</span><br><span class="line">        <span class="built_in">this</span>(b.x - a.x, b.y - a.y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vector(Point p) &#123;</span><br><span class="line">        <span class="built_in">this</span>(p.x, p.y);</span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="基本运算"><a href="#基本运算" class="headerlink" title="基本运算"></a>基本运算</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Point <span class="title function_">add</span><span class="params">(Point r)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Point</span>(x + r.x, y + r.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Point <span class="title function_">sub</span><span class="params">(Point r)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Point</span>(x - r.x, y - r.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Point <span class="title function_">mul</span><span class="params">(<span class="type">double</span> r)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Point</span>(x * r, y * r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Point <span class="title function_">move</span><span class="params">(<span class="type">double</span> dx, <span class="type">double</span> dy)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Point</span>(x + dx, y + dy);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Point <span class="title function_">rotate</span><span class="params">(<span class="type">double</span> a)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Point</span>(x * Math.cos(a) - y * Math.sin(a), x * Math.sin(a) + y * Math.cos(a));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Point <span class="title function_">rotate</span><span class="params">(<span class="type">double</span> dx, <span class="type">double</span> dy, <span class="type">double</span> a)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.move(-dx, -dy).rotate(a).move(dx, dy);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Vector <span class="title function_">normal</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">double</span> <span class="variable">len</span> <span class="operator">=</span> <span class="built_in">this</span>.length();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Vector</span>(-y / len, x / len);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数计算-1"><a href="#函数计算-1" class="headerlink" title="函数计算"></a>函数计算</h3><ul>
<li>求点积</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">dot</span><span class="params">(Vector r)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x * r.x + y * r.y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>求叉积</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">cross</span><span class="params">(Vector r)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x * r.y - y * r.x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>求向量的模</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">length</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.sqrt(<span class="built_in">this</span>.dot(<span class="built_in">this</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>求不共线的三点所成角$ \angle AOB$:</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">angle</span><span class="params">(Point o, Point a, Point b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> angle(<span class="keyword">new</span> <span class="title class_">Vector</span>(o, a), <span class="keyword">new</span> <span class="title class_">Vector</span>(o, b));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">angle</span><span class="params">(Vector a, Vector b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.acos(dot(a, b) / a.length() / b.length());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">angle</span><span class="params">(Point a, Point b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> angle(<span class="keyword">new</span> <span class="title class_">Vector</span>(a), <span class="keyword">new</span> <span class="title class_">Vector</span>(b));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Line-直线-线段"><a href="#Line-直线-线段" class="headerlink" title="Line 直线&#x2F;线段"></a>Line 直线&#x2F;线段</h2><h3 id="类定义-2"><a href="#类定义-2" class="headerlink" title="类定义"></a>类定义</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Line</span> <span class="keyword">extends</span> <span class="title class_">Vector</span> &#123;</span><br><span class="line">    Point s, e;</span><br><span class="line"></span><br><span class="line">    Line() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Line(Point _s, Point _e) &#123;</span><br><span class="line">        s = _s;</span><br><span class="line">        e = _e;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Line(<span class="type">double</span> x1, <span class="type">double</span> y1, <span class="type">double</span> x2, <span class="type">double</span> y2) &#123;</span><br><span class="line">        <span class="built_in">this</span>(<span class="keyword">new</span> <span class="title class_">Point</span>(x1, y1), <span class="keyword">new</span> <span class="title class_">Point</span>(x2, y2));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vector <span class="title function_">vector</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Vector</span>(s, e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="关系判断"><a href="#关系判断" class="headerlink" title="关系判断"></a>关系判断</h3><ul>
<li>判断直线相交</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isLineInter</span><span class="params">(Line l1, Line l2)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (l1.s.equals(l1.e) || l2.s.equals(l2.e))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> dcmp(cross(l2.s, l1.s, l1.e) * cross(l2.e, l1.s, l1.e)) &lt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>判断线段相交</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isSegInter</span><span class="params">(Point s1, Point e1, Point s2, Point e2)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (dcmp(Math.min(s1.x, e1.x) - Math.max(s2.x, e2.x)) &lt;= <span class="number">0</span></span><br><span class="line">            &amp;&amp; dcmp(Math.min(s1.y, e1.y) - Math.max(s2.y, e2.y)) &lt;= <span class="number">0</span></span><br><span class="line">            &amp;&amp; dcmp(Math.min(s2.x, e2.x) - Math.max(s1.x, e1.x)) &lt;= <span class="number">0</span></span><br><span class="line">            &amp;&amp; dcmp(Math.min(s2.y, e2.y) - Math.max(s1.y, e1.y)) &lt;= <span class="number">0</span></span><br><span class="line">            &amp;&amp; dcmp(Vector.cross(s2, e2, s1) * Vector.cross(s2, e2, e1)) &lt;= <span class="number">0</span></span><br><span class="line">            &amp;&amp; dcmp(Vector.cross(s1, e1, s2) * Vector.cross(s1, e1, e2)) &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isSegInter2</span><span class="params">(Point p1, Point p2, Point p3, Point p4)</span> <span class="comment">// vigorous intersection</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> dcmp(cross(p3, p4, p1)) * dcmp(cross(p3, p4, p2)) == -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isSegInter</span><span class="params">(Line l1, Line l2)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> isSegInter(l1.s, l1.e, l2.s, l2.e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isSegInter2</span><span class="params">(Line l1, Line l2)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> isSegInter2(l1.s, l1.e, l2.s, l2.e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="函数计算-2"><a href="#函数计算-2" class="headerlink" title="函数计算"></a>函数计算</h3><ul>
<li>求两直线交点</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Point <span class="title function_">GetLineIntersection</span><span class="params">(Point p, Vector v, Point q, Vector w)</span> &#123;</span><br><span class="line">       <span class="type">Vector</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Vector</span>(p.sub(q));</span><br><span class="line">       <span class="type">double</span> <span class="variable">t</span> <span class="operator">=</span> cross(w, u) / cross(v, w);</span><br><span class="line">       <span class="keyword">return</span> p.add(v.mul(t));</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   Point <span class="title function_">GetLineIntersection</span><span class="params">(Point p, Point v, Point q, Point w)</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> GetLineIntersection(p, <span class="keyword">new</span> <span class="title class_">Vector</span>(v), q, <span class="keyword">new</span> <span class="title class_">Vector</span>(w));</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Polygon-多边形"><a href="#Polygon-多边形" class="headerlink" title="Polygon 多边形"></a>Polygon 多边形</h2><h3 id="类定义-3"><a href="#类定义-3" class="headerlink" title="类定义"></a>类定义</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Polygon</span> <span class="keyword">extends</span> <span class="title class_">Vector</span> &#123;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">    Point[] v;</span><br><span class="line"></span><br><span class="line">    Polygon() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Polygon(<span class="type">int</span> n) &#123;</span><br><span class="line">        num = n;</span><br><span class="line">        v = <span class="keyword">new</span> <span class="title class_">Point</span>[num + <span class="number">2</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="关系判断-1"><a href="#关系判断-1" class="headerlink" title="关系判断"></a>关系判断</h3><ul>
<li>凸包判断</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">IsConvexBag</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">direction</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">// 1:counter-clockwise -1:clockwise</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> dcmp(cross(v[i], v[i + <span class="number">1</span>], v[i + <span class="number">1</span>], v[i + <span class="number">2</span>]));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (direction == <span class="number">0</span>) <span class="comment">// prevent co-line</span></span><br><span class="line">                direction = tmp;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (direction * tmp &lt; <span class="number">0</span>) <span class="comment">// as Vec is a ConvexBag,direction*temp&gt;=0 no matter how direction rotates</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Round-圆"><a href="#Round-圆" class="headerlink" title="Round 圆"></a>Round 圆</h2><h3 id="类定义-4"><a href="#类定义-4" class="headerlink" title="类定义"></a>类定义</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Round</span> <span class="keyword">extends</span> <span class="title class_">Vector</span> &#123;</span><br><span class="line">    <span class="type">double</span> r;</span><br><span class="line">    Point o;</span><br><span class="line"></span><br><span class="line">    Round(<span class="type">double</span> _r, <span class="type">double</span> _x, <span class="type">double</span> _y) &#123;</span><br><span class="line">        r = _r;</span><br><span class="line">        x = _x;</span><br><span class="line">        y = _y;</span><br><span class="line">        o = <span class="keyword">new</span> <span class="title class_">Point</span>(x, y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">double</span> <span class="title function_">Area</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> pi * r * r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数计算-3"><a href="#函数计算-3" class="headerlink" title="函数计算"></a>函数计算</h3><ul>
<li>求两圆面积交</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">CommonArea</span><span class="params">(Round A, Round B)</span> &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">area</span> <span class="operator">=</span> <span class="number">0.0</span>;</span><br><span class="line">        <span class="type">Round</span> <span class="variable">M</span> <span class="operator">=</span> dcmp(A.r - B.r) &gt; <span class="number">0</span> ? A : B;</span><br><span class="line">        <span class="type">Round</span> <span class="variable">N</span> <span class="operator">=</span> dcmp(A.r - B.r) &gt; <span class="number">0</span> ? B : A;</span><br><span class="line">        <span class="type">double</span> <span class="variable">D</span> <span class="operator">=</span> dist(M.o, N.o);</span><br><span class="line">        <span class="keyword">if</span> (dcmp(M.r + N.r - D) &gt; <span class="number">0</span> &amp;&amp; dcmp(M.r - N.r - D) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">double</span> <span class="variable">cosM</span> <span class="operator">=</span> (M.r * M.r + D * D - N.r * N.r) / (<span class="number">2.0</span> * M.r * D);</span><br><span class="line">            <span class="type">double</span> <span class="variable">cosN</span> <span class="operator">=</span> (N.r * N.r + D * D - M.r * M.r) / (<span class="number">2.0</span> * N.r * D);</span><br><span class="line">            <span class="type">double</span> <span class="variable">alpha</span> <span class="operator">=</span> <span class="number">2.0</span> * Math.acos(cosM);</span><br><span class="line">            <span class="type">double</span> <span class="variable">beta</span> <span class="operator">=</span> <span class="number">2.0</span> * Math.acos(cosN);</span><br><span class="line"></span><br><span class="line">            <span class="type">double</span> <span class="variable">TM</span> <span class="operator">=</span> <span class="number">0.5</span> * M.r * M.r * Math.sin(alpha);</span><br><span class="line">            <span class="type">double</span> <span class="variable">TN</span> <span class="operator">=</span> <span class="number">0.5</span> * N.r * N.r * Math.sin(beta);</span><br><span class="line">            <span class="type">double</span> <span class="variable">FM</span> <span class="operator">=</span> <span class="number">0.5</span> * alpha / pi * M.Area();</span><br><span class="line">            <span class="type">double</span> <span class="variable">FN</span> <span class="operator">=</span> <span class="number">0.5</span> * beta / pi * N.Area();</span><br><span class="line">            area = FM + FN - TM - TN;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dcmp(M.r - N.r - D) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            area = N.Area();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> area;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>求三角形与圆面积交</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">TriAngleCircleInsection</span><span class="params">(Round C, Point A, Point B)</span> &#123;</span><br><span class="line">        <span class="type">Vector</span> <span class="variable">OA</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Vector</span>(A.sub(C.o)), OB = <span class="keyword">new</span> <span class="title class_">Vector</span>(B.sub(C.o));</span><br><span class="line">        <span class="type">Vector</span> <span class="variable">BA</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Vector</span>(A.sub(B)), BC = <span class="keyword">new</span> <span class="title class_">Vector</span>(C.o.sub(B));</span><br><span class="line">        <span class="type">Vector</span> <span class="variable">AB</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Vector</span>(B.sub(A)), AC = <span class="keyword">new</span> <span class="title class_">Vector</span>(C.o.sub(A));</span><br><span class="line">        <span class="type">double</span> <span class="variable">DOA</span> <span class="operator">=</span> OA.length(), DOB = OB.length(), DAB = AB.length(), r = C.r;</span><br><span class="line">        <span class="keyword">if</span> (dcmp(cross(OA, OB)) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (dcmp(DOA - C.r) &lt; <span class="number">0</span> &amp;&amp; dcmp(DOB - C.r) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> cross(OA, OB) * <span class="number">0.5</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (dcmp(DOB - r) &lt; <span class="number">0</span> &amp;&amp; dcmp(DOA - r) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">double</span> <span class="variable">x</span> <span class="operator">=</span> (dot(BA, BC) + Math.sqrt(r * r * DAB * DAB - cross(BA, BC) * cross(BA, BC))) / DAB;</span><br><span class="line">            <span class="type">double</span> <span class="variable">TS</span> <span class="operator">=</span> cross(OA, OB) * <span class="number">0.5</span>;</span><br><span class="line">            <span class="keyword">return</span> Math.asin(TS * (<span class="number">1</span> - x / DAB) * <span class="number">2</span> / r / DOA) * r * r * <span class="number">0.5</span> + TS * x / DAB;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dcmp(DOB - r) &gt;= <span class="number">0</span> &amp;&amp; dcmp(DOA - r) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">double</span> <span class="variable">y</span> <span class="operator">=</span> (dot(AB, AC) + Math.sqrt(r * r * DAB * DAB - cross(AB, AC) * cross(AB, AC))) / DAB;</span><br><span class="line">            <span class="type">double</span> <span class="variable">TS</span> <span class="operator">=</span> cross(OA, OB) * <span class="number">0.5</span>;</span><br><span class="line">            <span class="keyword">return</span> Math.asin(TS * (<span class="number">1</span> - y / DAB) * <span class="number">2</span> / r / DOB) * r * r * <span class="number">0.5</span> + TS * y / DAB;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dcmp(Math.abs(cross(OA, OB)) - r * DAB) &gt;= <span class="number">0</span> || dcmp(dot(AB, AC)) &lt;= <span class="number">0</span> || dcmp(dot(BA, BC)) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dcmp(dot(OA, OB)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (dcmp(cross(OA, OB)) &lt; <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">return</span> (-Math.acos(-<span class="number">1.0</span>) - Math.asin(cross(OA, OB) / DOA / DOB)) * r * r * <span class="number">0.5</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">return</span> (Math.acos(-<span class="number">1.0</span>) - Math.asin(cross(OA, OB) / DOA / DOB)) * r * r * <span class="number">0.5</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> Math.asin(cross(OA, OB) / DOA / DOB) * r * r * <span class="number">0.5</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">double</span> <span class="variable">x</span> <span class="operator">=</span> (dot(BA, BC) + Math.sqrt(r * r * DAB * DAB - cross(BA, BC) * cross(BA, BC))) / DAB;</span><br><span class="line">            <span class="type">double</span> <span class="variable">y</span> <span class="operator">=</span> (dot(AB, AC) + Math.sqrt(r * r * DAB * DAB - cross(AB, AC) * cross(AB, AC))) / DAB;</span><br><span class="line">            <span class="type">double</span> <span class="variable">TS</span> <span class="operator">=</span> cross(OA, OB) * <span class="number">0.5</span>;</span><br><span class="line">            <span class="keyword">return</span> (Math.asin(TS * (<span class="number">1</span> - x / DAB) * <span class="number">2</span> / r / DOA) + Math.asin(TS * (<span class="number">1</span> - y / DAB) * <span class="number">2</span> / r / DOB)) * r * r</span><br><span class="line">                    * <span class="number">0.5</span> + TS * ((x + y) / DAB - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Judge-关系判断"><a href="#Judge-关系判断" class="headerlink" title="Judge 关系判断"></a>Judge 关系判断</h3><ul>
<li>判断圆是否在多边形内部</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">IsInPoly</span><span class="params">(Polygon pl)</span> &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">CircleAngle</span> <span class="operator">=</span> <span class="number">0.0</span>; <span class="comment">// rotation angle</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= pl.num; i++) <span class="comment">// ignore the repetitive edges</span></span><br><span class="line">            <span class="keyword">if</span> (dcmp(cross(o, pl.v[i], o, pl.v[i + <span class="number">1</span>])) &gt;= <span class="number">0</span>)</span><br><span class="line">                CircleAngle += angle(o, pl.v[i], pl.v[i + <span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                CircleAngle -= angle(o, pl.v[i], pl.v[i + <span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (dcmp(CircleAngle) == <span class="number">0</span>) <span class="comment">// CircleAngle=0, Peg outside</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (dcmp(CircleAngle - pi) == <span class="number">0</span> || dcmp(CircleAngle + pi) == <span class="number">0</span>) <span class="comment">// CircleAngle=180,</span></span><br><span class="line">                                                                                <span class="comment">// Peg inside(excluding vertices)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (dcmp(r) == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dcmp(CircleAngle - <span class="number">2</span> * pi) == <span class="number">0</span> || dcmp(CircleAngle + <span class="number">2</span> * pi) == <span class="number">0</span>) <span class="comment">// CircleAngle=360, Peg inside</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="comment">// CircleAngle in range (0,360)， Peg on the vertex</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (dcmp(r) == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>判断圆是否包含多边形</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">IsFitPoly</span><span class="params">(Polygon pl)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= pl.num; i++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> dcmp(Math.abs(cross(o, pl.v[i], o, pl.v[i + <span class="number">1</span>]) / dist(pl.v[i], pl.v[i + <span class="number">1</span>])) - r);</span><br><span class="line">        <span class="keyword">if</span> (k &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="String-字符串篇"><a href="#String-字符串篇" class="headerlink" title="String 字符串篇"></a>String 字符串篇</h1><h2 id="The-Knuth-Morris-Pratt-Algorithm-KMP算法"><a href="#The-Knuth-Morris-Pratt-Algorithm-KMP算法" class="headerlink" title="The Knuth-Morris-Pratt Algorithm KMP算法"></a>The Knuth-Morris-Pratt Algorithm KMP算法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">KMP</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> next[];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getNext</span><span class="params">(String T)</span> &#123;</span><br><span class="line">        next = <span class="keyword">new</span> <span class="title class_">int</span>[T.length() + <span class="number">1</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>, k = -<span class="number">1</span>;</span><br><span class="line">        next[<span class="number">0</span>] = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (j &lt; T.length())</span><br><span class="line">            <span class="keyword">if</span> (k == -<span class="number">1</span> || T.charAt(j) == T.charAt(k))</span><br><span class="line">                next[++j] = ++k;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                k = next[k];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">Index</span><span class="params">(String S, String T)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">        getNext(T);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; S.length() &amp;&amp; j &lt; T.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; S.charAt(i) != T.charAt(j))</span><br><span class="line">                j = next[j];</span><br><span class="line">            <span class="keyword">if</span> (S.charAt(i) == T.charAt(j))</span><br><span class="line">                j++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (j == T.length())</span><br><span class="line">            <span class="keyword">return</span> i - T.length();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">Count</span><span class="params">(String S, String T)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (S.length() == <span class="number">1</span> &amp;&amp; T.length() == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (S.charAt(<span class="number">0</span>) == T.charAt(<span class="number">0</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        getNext(T);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; S.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; S.charAt(i) != T.charAt(j))</span><br><span class="line">                j = next[j];</span><br><span class="line">            <span class="keyword">if</span> (S.charAt(i) == T.charAt(j))</span><br><span class="line">                j++;</span><br><span class="line">            <span class="keyword">if</span> (j == T.length()) &#123;</span><br><span class="line">                res++;</span><br><span class="line">                j = next[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Trie-字典树"><a href="#Trie-字典树" class="headerlink" title="Trie 字典树"></a>Trie 字典树</h2><p>存储仅含有小写英文字母的单词。<br><code>insert</code>执行插入操作，<code>query</code>返回（存在该单词的前提下）某单词与其他任一单词的最长公共前缀长度。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Trie</span> &#123;</span><br><span class="line">	<span class="type">int</span> cnt;</span><br><span class="line">	Trie[] child;</span><br><span class="line"></span><br><span class="line">	Trie() &#123;</span><br><span class="line">		child = <span class="keyword">new</span> <span class="title class_">Trie</span>[<span class="number">26</span>];</span><br><span class="line">		cnt = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(String s, <span class="type">int</span> p)</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">ch</span> <span class="operator">=</span> s.charAt(p) - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span> (child[ch] == <span class="literal">null</span>)</span><br><span class="line">			child[ch] = <span class="keyword">new</span> <span class="title class_">Trie</span>();</span><br><span class="line">		child[ch].cnt++;</span><br><span class="line">		<span class="keyword">if</span> (p &lt; s.length() - <span class="number">1</span>)</span><br><span class="line">			child[ch].insert(s, p + <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> <span class="title function_">query</span><span class="params">(String s, <span class="type">int</span> p)</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">ch</span> <span class="operator">=</span> s.charAt(p) - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span> (child[ch].cnt &lt; <span class="number">2</span> || p &gt;= s.length() - <span class="number">1</span>)</span><br><span class="line">			<span class="keyword">return</span> p;</span><br><span class="line">		<span class="keyword">return</span> child[ch].query(s, p + <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Aho-Corasick-automaton-AC自动机"><a href="#Aho-Corasick-automaton-AC自动机" class="headerlink" title="Aho-Corasick automaton AC自动机"></a>Aho-Corasick automaton AC自动机</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AC</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">maxl</span> <span class="operator">=</span> <span class="number">500010</span>, maxc = <span class="number">26</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">char</span> <span class="variable">fstc</span> <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="type">int</span> root, L;</span><br><span class="line">    <span class="type">int</span>[][] next;</span><br><span class="line">    <span class="type">int</span>[] fail, end;</span><br><span class="line">    Queue&lt;Integer&gt; que = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">    AC() &#123;</span><br><span class="line">        next = <span class="keyword">new</span> <span class="title class_">int</span>[maxl][maxc];</span><br><span class="line">        fail = <span class="keyword">new</span> <span class="title class_">int</span>[maxl];</span><br><span class="line">        end = <span class="keyword">new</span> <span class="title class_">int</span>[maxl];</span><br><span class="line">        L = <span class="number">0</span>;</span><br><span class="line">        root = newnode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        Arrays.fill(fail, <span class="number">0</span>);</span><br><span class="line">        Arrays.fill(end, <span class="number">0</span>);</span><br><span class="line">        L = <span class="number">0</span>;</span><br><span class="line">        root = newnode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">newnode</span><span class="params">()</span> &#123;</span><br><span class="line">        Arrays.fill(next[L], -<span class="number">1</span>);</span><br><span class="line">        end[L++] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> L - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">now</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">ch</span> <span class="operator">=</span> str.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (next[now][ch - fstc] == -<span class="number">1</span>)</span><br><span class="line">                next[now][ch - fstc] = newnode();</span><br><span class="line">            now = next[now][ch - fstc];</span><br><span class="line">        &#125;</span><br><span class="line">        end[now]++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">build</span><span class="params">()</span> &#123;</span><br><span class="line">        que.clear();</span><br><span class="line">        fail[root] = root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxc; i++)</span><br><span class="line">            <span class="keyword">if</span> (next[root][i] == -<span class="number">1</span>)</span><br><span class="line">                next[root][i] = root;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                fail[next[root][i]] = root;</span><br><span class="line">                que.add(next[root][i]);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">now</span> <span class="operator">=</span> que.poll();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxc; i++)</span><br><span class="line">                <span class="keyword">if</span> (next[now][i] == -<span class="number">1</span>)</span><br><span class="line">                    next[now][i] = next[fail[now]][i];</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    fail[next[now][i]] = next[fail[now]][i];</span><br><span class="line">                    que.add(next[now][i]);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">query</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">now</span> <span class="operator">=</span> root, res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">ch</span> <span class="operator">=</span> str.charAt(i);</span><br><span class="line">            now = next[now][ch - fstc];</span><br><span class="line">            <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> now;</span><br><span class="line">            <span class="keyword">while</span> (tmp != root) &#123;</span><br><span class="line">                res += end[tmp];</span><br><span class="line">                <span class="comment">// end[tmp] = 0;</span></span><br><span class="line">                tmp = fail[tmp];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Network-Flowing-网络流篇"><a href="#Network-Flowing-网络流篇" class="headerlink" title="Network Flowing 网络流篇"></a>Network Flowing 网络流篇</h1><h2 id="Dinic-最大流-最小割"><a href="#Dinic-最大流-最小割" class="headerlink" title="Dinic 最大流&#x2F;最小割"></a>Dinic 最大流&#x2F;最小割</h2><p>需应用数据结构<code>弧</code>、<code>链式前向星</code>并用以下函数代替<code>addEdge</code>（可能需改动参数）：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> &#123;</span><br><span class="line">		e[num].modify(v, w, <span class="number">0</span>, h[u]);</span><br><span class="line">		h[u] = num++;</span><br><span class="line">		e[num].modify(u, w, <span class="number">0</span>, h[v]);</span><br><span class="line">		h[v] = num++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">	<span class="keyword">final</span> <span class="type">int</span> <span class="variable">inf</span> <span class="operator">=</span> <span class="number">0x3fffffff</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> maxm, maxn;</span><br><span class="line">	<span class="keyword">public</span> Graph g;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span>[] dist;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">boolean</span>[] vis;</span><br><span class="line">	<span class="keyword">private</span> Queue&lt;Integer&gt; que;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Dinic</span><span class="params">(<span class="type">int</span> _n, <span class="type">int</span> _m)</span> &#123;</span><br><span class="line">		maxn = _n;</span><br><span class="line">		maxm = _m;</span><br><span class="line">		que = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;Integer&gt;();</span><br><span class="line">		dist = <span class="keyword">new</span> <span class="title class_">int</span>[maxn];</span><br><span class="line">		vis = <span class="keyword">new</span> <span class="title class_">boolean</span>[maxn];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (g == <span class="literal">null</span>)</span><br><span class="line">			g = <span class="keyword">new</span> <span class="title class_">Graph</span>(maxn, maxm);</span><br><span class="line">		g.init();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">init</span><span class="params">(Graph _g)</span> &#123;</span><br><span class="line">		g = _g;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> &#123;</span><br><span class="line">		g.addedge(u, v, w);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">boolean</span> <span class="title function_">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> &#123;</span><br><span class="line">		que.clear();</span><br><span class="line">		Arrays.fill(dist, -<span class="number">1</span>);</span><br><span class="line">		Arrays.fill(vis, <span class="literal">false</span>);</span><br><span class="line">		dist[s] = <span class="number">0</span>;</span><br><span class="line">		que.add(s);</span><br><span class="line">		vis[s] = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">			<span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> que.poll();</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> g.h[u]; i != -<span class="number">1</span>; i = g.e[i].next) &#123;</span><br><span class="line">				<span class="type">Edge</span> <span class="variable">E</span> <span class="operator">=</span> g.e[i];</span><br><span class="line">				<span class="keyword">if</span> (!vis[E.to] &amp;&amp; E.cap &gt; E.flow) &#123;</span><br><span class="line">					dist[E.to] = dist[u] + <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">if</span> (E.to == t)</span><br><span class="line">						<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">					vis[E.to] = <span class="literal">true</span>;</span><br><span class="line">					que.add(E.to);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> delta, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (u == target || delta == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> delta;</span><br><span class="line">		<span class="type">int</span> <span class="variable">flow</span> <span class="operator">=</span> <span class="number">0</span>, f;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> g.h[u]; i != -<span class="number">1</span>; i = g.e[i].next) &#123;</span><br><span class="line">			<span class="type">Edge</span> <span class="variable">E</span> <span class="operator">=</span> g.e[i];</span><br><span class="line">			<span class="keyword">if</span> (dist[E.to] == dist[u] + <span class="number">1</span> &amp;&amp; (f = dfs(E.to, Math.min(delta, E.cap - E.flow), target)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				g.e[i].flow += f;</span><br><span class="line">				g.e[i ^ <span class="number">1</span>].flow -= f;</span><br><span class="line">				flow += f;</span><br><span class="line">				delta -= f;</span><br><span class="line">				<span class="keyword">if</span> (delta == <span class="number">0</span>)</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> <span class="title function_">maxflow</span><span class="params">(<span class="type">int</span> source, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">flow</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (bfs(source, target)) &#123;</span><br><span class="line">			flow += dfs(source, inf, target);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


<h2 id="费用流"><a href="#费用流" class="headerlink" title="费用流"></a>费用流</h2><p>求解最小费用最大流。<br>若需要最大费用，可将各边费用取反，最终所得结果亦取反。<br>需应用数据结构<code>有向边</code>、<code>链式前向星</code>并用以下函数代替<code>addEdge</code>：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> f, <span class="type">int</span> w)</span> &#123;</span><br><span class="line">		e[num].modify(v, f, w, h[u]);</span><br><span class="line">		h[u] = num++;</span><br><span class="line">		e[num].modify(u, <span class="number">0</span>, -w, h[v]);</span><br><span class="line">		h[v] = num++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MinCostMaxFlow</span> &#123;</span><br><span class="line">	<span class="keyword">final</span> <span class="type">int</span> <span class="variable">inf</span> <span class="operator">=</span> <span class="number">0x3fffffff</span>;</span><br><span class="line">	<span class="type">int</span> maxn, maxm;</span><br><span class="line">	Graph g;</span><br><span class="line">	spfa work;</span><br><span class="line">	<span class="type">int</span> num, src, sink;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">MinCostMaxFlow</span><span class="params">(<span class="type">int</span> _n, <span class="type">int</span> _m)</span> &#123;</span><br><span class="line">		maxn = _n;</span><br><span class="line">		maxm = _m;</span><br><span class="line">		work = <span class="keyword">new</span> <span class="title class_">spfa</span>(maxn, maxm);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">init</span><span class="params">(<span class="type">int</span> _u, <span class="type">int</span> _v)</span> &#123;</span><br><span class="line">		src = _u;</span><br><span class="line">		sink = _v;</span><br><span class="line">		<span class="keyword">if</span> (g == <span class="literal">null</span>)</span><br><span class="line">			g = <span class="keyword">new</span> <span class="title class_">Graph</span>(maxn, maxm);</span><br><span class="line">		g.init();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">init</span><span class="params">(Graph _g, <span class="type">int</span> _u, <span class="type">int</span> _v)</span> &#123;</span><br><span class="line">		src = _u;</span><br><span class="line">		sink = _v;</span><br><span class="line">		g = _g;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> f, <span class="type">int</span> w)</span> &#123;</span><br><span class="line">		g.addEdge(u, v, f, w);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">boolean</span> <span class="title function_">findPath</span><span class="params">()</span> &#123;</span><br><span class="line">		work.init(g, src);</span><br><span class="line">		<span class="keyword">return</span> work.get_res(sink) &lt; inf;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> <span class="title function_">solve</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">cost</span> <span class="operator">=</span> <span class="number">0</span>, flow = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (findPath()) &#123;</span><br><span class="line">			<span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> sink;</span><br><span class="line">			<span class="type">int</span> <span class="variable">delta</span> <span class="operator">=</span> inf;</span><br><span class="line">			<span class="keyword">while</span> (u != src) &#123;</span><br><span class="line">				delta = Math.min(delta, g.e[work.pree[u]].f);</span><br><span class="line">				u = work.prev[u];</span><br><span class="line">			&#125;</span><br><span class="line">			u = sink;</span><br><span class="line">			<span class="keyword">while</span> (u != src) &#123;</span><br><span class="line">				g.e[work.pree[u]].f -= delta;</span><br><span class="line">				g.e[work.pree[u] ^ <span class="number">1</span>].f += delta;</span><br><span class="line">				u = work.prev[u];</span><br><span class="line">			&#125;</span><br><span class="line">			cost += work.dis[sink] * delta;</span><br><span class="line">			flow += delta;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> cost;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="差分约束"><a href="#差分约束" class="headerlink" title="差分约束"></a>差分约束</h1><p>差分约束系统（system of difference constraints），是求解关于一组变数的特殊不等式组之方法。<br>如果一个系统由n个变量和m个约束条件组成，其中每个约束条件形如$ x_j-x_i \le b_k(i,j∈[1,n],k∈[1,m]) $,则称其为差分约束系统(system of difference constraints)。亦即，差分约束系统是求解关于一组变量的特殊不等式组的方法。<br>求解差分约束系统，可以转化成图论的单源最短路径问题。观察$ x_j-x_i \le b_k $，会发现它类似最短路中的三角不等式$ d[v] \le d[u]+w[u,v] $，即$ d[v]-d[u] \le w[u,v] $。因此，以每个变数$ x_i $为结点，对于约束条件$ x_j-x_i \le b_k $，连接一条边(i,j)，边权为$ b_k $。再增加一个原点(s,s)与所有定点相连，边权均为0。对这个图以s为原点运行Bellman-ford算法（或SPFA算法），最终{d[i]}即为一组可行解。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>ACM竞赛Java模板[dev-160504]</p><p><a href="https://devblog.citruxonve.net/posts/41b311d1/">https://devblog.citruxonve.net/posts/41b311d1/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Semprathlon / Simfae Dean</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>04/06/2016</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>08/18/2025</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Template/">Template</a><a class="link-muted mr-2" rel="tag" href="/tags/Java/">Java</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=60e3b95fb3bfa200125f409c&amp;product=inline-share-buttons" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/posts/561c3d53/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">BestCoder</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/a6ec002a/"><span class="level-item">hdu 4828 Grids Catalan数例题</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">Comments</h3><script src="https://utteranc.es/client.js" repo="CitruXonve/devblog" issue-term="pathname" label="utteranc" theme="github-light" crossorigin="anonymous" async></script></div></div></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://ui-avatars.com/api/?name=Citru+Xonve&amp;background=0D8ABC&amp;color=fff&amp;size=128" alt="CitruXonve"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">CitruXonve</p><p class="is-size-6 is-block">Fullstack Developer, Data Platform, UI/UX</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Sunnyvale, CA, US</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives/"><p class="title">292</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories/"><p class="title">36</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags/"><p class="title">147</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/CitruXonve" target="_blank" rel="me noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/CitruXonve"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Facebook" href="https://www.facebook.com/IrisAmamiya/"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Twitter" href="https://twitter.com/Iris_Amamiya/"><i class="fab fa-twitter"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/ACM-ICPC/"><span class="level-start"><span class="level-item">ACM-ICPC</span></span><span class="level-end"><span class="level-item tag">95</span></span></a><ul><li><a class="level is-mobile" href="/categories/ACM-ICPC/Programing/"><span class="level-start"><span class="level-item">Programing</span></span><span class="level-end"><span class="level-item tag">94</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/About/"><span class="level-start"><span class="level-item">About</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile" href="/categories/Computing/"><span class="level-start"><span class="level-item">Computing</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/Computing/Developing/"><span class="level-start"><span class="level-item">Developing</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Computing/Graphic/"><span class="level-start"><span class="level-item">Graphic</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Computing/Graphic/Developing/"><span class="level-start"><span class="level-item">Developing</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/Computing-Cloud/"><span class="level-start"><span class="level-item">Computing - Cloud</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/Computing-Cloud/Notes/"><span class="level-start"><span class="level-item">Notes</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Criticisms/"><span class="level-start"><span class="level-item">Criticisms</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Deployment/"><span class="level-start"><span class="level-item">Deployment</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/DevOps/"><span class="level-start"><span class="level-item">DevOps</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Developing/"><span class="level-start"><span class="level-item">Developing</span></span><span class="level-end"><span class="level-item tag">25</span></span></a><ul><li><a class="level is-mobile" href="/categories/Developing/Environment/"><span class="level-start"><span class="level-item">Environment</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Developing/Server/"><span class="level-start"><span class="level-item">Server</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/Developing/Server/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Developing/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Development/"><span class="level-start"><span class="level-item">Development</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/English/"><span class="level-start"><span class="level-item">English</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Environment/"><span class="level-start"><span class="level-item">Environment</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Environment/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Git/"><span class="level-start"><span class="level-item">Git</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Graphic/"><span class="level-start"><span class="level-item">Graphic</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/Graphic/Developing/"><span class="level-start"><span class="level-item">Developing</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/Graphic/Developing/Game/"><span class="level-start"><span class="level-item">Game</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/Hardware/"><span class="level-start"><span class="level-item">Hardware</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Industrial/"><span class="level-start"><span class="level-item">Industrial</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">34</span></span></a></li><li><a class="level is-mobile" href="/categories/Programing/"><span class="level-start"><span class="level-item">Programing</span></span><span class="level-end"><span class="level-item tag">21</span></span></a><ul><li><a class="level is-mobile" href="/categories/Programing/ACM-ICPC/"><span class="level-start"><span class="level-item">ACM-ICPC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Programing/ACM-ICPC/Programing/"><span class="level-start"><span class="level-item">Programing</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/Server/"><span class="level-start"><span class="level-item">Server</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/Web/About/"><span class="level-start"><span class="level-item">About</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/iOS/"><span class="level-start"><span class="level-item">iOS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ACM-ICPC/"><span class="tag">ACM-ICPC</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/"><span class="tag">AC自动机</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AWS/"><span class="tag">AWS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Adobe/"><span class="tag">Adobe</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Angular/"><span class="tag">Angular</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Apache/"><span class="tag">Apache</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Arch-Linux/"><span class="tag">Arch Linux</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BFS/"><span class="tag">BFS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BIT/"><span class="tag">BIT</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bestcoder/"><span class="tag">Bestcoder</span><span class="tag">23</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bitset/"><span class="tag">Bitset</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bootstrap/"><span class="tag">Bootstrap</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C++</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CCPC/"><span class="tag">CCPC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Catalan/"><span class="tag">Catalan</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CentOS/"><span class="tag">CentOS</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Clover/"><span class="tag">Clover</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Compiler/"><span class="tag">Compiler</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Contest/"><span class="tag">Contest</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cpp/"><span class="tag">Cpp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DFS/"><span class="tag">DFS</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DNS/"><span class="tag">DNS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DP/"><span class="tag">DP</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DSDT/"><span class="tag">DSDT</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Analytics/"><span class="tag">Data Analytics</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dinic/"><span class="tag">Dinic</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Eclipse/"><span class="tag">Eclipse</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Expect/"><span class="tag">Expect</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Fibonacci/"><span class="tag">Fibonacci</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Frontend/"><span class="tag">Frontend</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GLUT/"><span class="tag">GLUT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GPT/"><span class="tag">GPT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GUI/"><span class="tag">GUI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Gentoo/"><span class="tag">Gentoo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Geometry/"><span class="tag">Geometry</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Github/"><span class="tag">Github</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Graduate/"><span class="tag">Graduate</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HTML/"><span class="tag">HTML</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hash/"><span class="tag">Hash</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Heap/"><span class="tag">Heap</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Interview/"><span class="tag">Interview</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JNUOJ/"><span class="tag">JNUOJ</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/K8s/"><span class="tag">K8s</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/KMP/"><span class="tag">KMP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Live-Archive/"><span class="tag">Live Archive</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MBR/"><span class="tag">MBR</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MS-DOS/"><span class="tag">MS=DOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mac/"><span class="tag">Mac</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Manhattan/"><span class="tag">Manhattan</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Multi-Uni/"><span class="tag">Multi-Uni</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MySQL/"><span class="tag">MySQL</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mobius%E5%8F%8D%E6%BC%94/"><span class="tag">Möbius反演</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NAS/"><span class="tag">NAS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NetworkFlow/"><span class="tag">NetworkFlow</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NoSQL/"><span class="tag">NoSQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OS/"><span class="tag">OS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenCV/"><span class="tag">OpenCV</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenGL/"><span class="tag">OpenGL</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RMQ/"><span class="tag">RMQ</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/React/"><span class="tag">React</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regional/"><span class="tag">Regional</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Repost/"><span class="tag">Repost</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ryzen/"><span class="tag">Ryzen</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQLserver/"><span class="tag">SQLserver</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SSL/"><span class="tag">SSL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/System-Design/"><span class="tag">System Design</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TOEFL/"><span class="tag">TOEFL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Template/"><span class="tag">Template</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tree/"><span class="tag">Tree</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Trie/"><span class="tag">Trie</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TypeScript/"><span class="tag">TypeScript</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/UEFI/"><span class="tag">UEFI</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/UX/"><span class="tag">UX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ubuntu/"><span class="tag">Ubuntu</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Unix/"><span class="tag">Unix</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows/"><span class="tag">Windows</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Wordpress/"><span class="tag">Wordpress</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ZFS/"><span class="tag">ZFS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ZOJ/"><span class="tag">ZOJ</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ajax/"><span class="tag">ajax</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/asm/"><span class="tag">asm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cuda/"><span class="tag">cuda</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cudnn/"><span class="tag">cudnn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/curl/"><span class="tag">curl</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/es6/"><span class="tag">es6</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/font/"><span class="tag">font</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ftp/"><span class="tag">ftp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gitlab/"><span class="tag">gitlab</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hardware/"><span class="tag">hardware</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hdu/"><span class="tag">hdu</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html/"><span class="tag">html</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/https/"><span class="tag">https</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/interview/"><span class="tag">interview</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jdk/"><span class="tag">jdk</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jquery/"><span class="tag">jquery</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/js/"><span class="tag">js</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/json/"><span class="tag">json</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kext/"><span class="tag">kext</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/network/"><span class="tag">network</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx/"><span class="tag">nginx</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nodejs/"><span class="tag">nodejs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/npm/"><span class="tag">npm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php/"><span class="tag">php</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react native</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/regex/"><span class="tag">regex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/string/"><span class="tag">string</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%88%86%E5%9B%BE/"><span class="tag">二分图</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"><span class="tag">二分查找</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%9A%E5%BC%88/"><span class="tag">博弈</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/"><span class="tag">容斥原理</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/"><span class="tag">并查集</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97/"><span class="tag">并行计算</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/"><span class="tag">微积分</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%89%AB%E6%8F%8F%E7%BA%BF/"><span class="tag">扫描线</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%88%97/"><span class="tag">数列</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E7%8B%AC/"><span class="tag">数独</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E8%AE%BA/"><span class="tag">数论</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A6%82%E7%8E%87/"><span class="tag">概率</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A8%A1%E6%8B%9F/"><span class="tag">模拟</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%AC%A7%E6%8B%89%E5%9B%9E%E8%B7%AF/"><span class="tag">欧拉回路</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F/"><span class="tag">百度之星</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%9F%A5%E4%B9%8E/"><span class="tag">知乎</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A6%BB%E6%95%A3%E5%8C%96/"><span class="tag">离散化</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%A6%E7%91%9F%E5%A4%AB/"><span class="tag">约瑟夫</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"><span class="tag">线段树</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"><span class="tag">组合数学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C%E8%B5%9B/"><span class="tag">网络赛</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%83%8C%E5%8C%85/"><span class="tag">背包</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/"><span class="tag">背包问题</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BD%AC%E8%BD%BD%E5%8D%9A%E6%96%87/"><span class="tag">转载博文</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%80%92%E5%BD%92/"><span class="tag">递归</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="http://marisa.moe/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">雾雨魔理沙</span></span><span class="level-right"><span class="level-item tag">marisa.moe</span></span></a></li><li><a class="level is-mobile" href="https://blinkfox.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">闪烁之狐</span></span><span class="level-right"><span class="level-item tag">blinkfox.github.io</span></span></a></li><li><a class="level is-mobile" href="https://phesoca.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">绯索卡</span></span><span class="level-right"><span class="level-item tag">phesoca.com</span></span></a></li><li><a class="level is-mobile" href="https://paperneko.moe/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">笈川伊織（紙喵）</span></span><span class="level-right"><span class="level-item tag">paperneko.moe</span></span></a></li><li><a class="level is-mobile" href="https://neko.ayaka.moe/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Ayaka Neko</span></span><span class="level-right"><span class="level-item tag">neko.ayaka.moe</span></span></a></li><li><a class="level is-mobile" href="https://blog.skk.moe/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Sukka</span></span><span class="level-right"><span class="level-item tag">blog.skk.moe</span></span></a></li><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li><li><a class="level is-mobile" href="https://funactional.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Function</span></span><span class="level-right"><span class="level-item tag">funactional.github.io</span></span></a></li><li><a class="level is-mobile" href="http://www.kuangbin.net/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">kuangbin</span></span><span class="level-right"><span class="level-item tag">www.kuangbin.net</span></span></a></li><li><a class="level is-mobile" href="http://hzwer.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">hzwer</span></span><span class="level-right"><span class="level-item tag">hzwer.com</span></span></a></li><li><a class="level is-mobile" href="http://tsyao.tk/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">tsyao</span></span><span class="level-right"><span class="level-item tag">tsyao.tk</span></span></a></li><li><a class="level is-mobile" href="http://c.ejq.me/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">氢酱</span></span><span class="level-right"><span class="level-item tag">c.ejq.me</span></span></a></li><li><a class="level is-mobile" href="http://coderunion.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CoderUnion</span></span><span class="level-right"><span class="level-item tag">coderunion.github.io</span></span></a></li><li><a class="level is-mobile" href="https://github.com/dangxuandev" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">当轩</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://zhuanlan.zhihu.com/simplyy" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">SimplyY</span></span><span class="level-right"><span class="level-item tag">zhuanlan.zhihu.com</span></span></a></li><li><a class="level is-mobile" href="http://blog.xen0n.name/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">xen0n</span></span><span class="level-right"><span class="level-item tag">blog.xen0n.name</span></span></a></li><li><a class="level is-mobile" href="https://github.com/NaturalL" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">NaturalL</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://huaji8.top/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">幻想帖</span></span><span class="level-right"><span class="level-item tag">huaji8.top</span></span></a></li><li><a class="level is-mobile" href="https://otakism.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">宅談</span></span><span class="level-right"><span class="level-item tag">otakism.com</span></span></a></li><li><a class="level is-mobile" href="https://liyin.date/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">天空之间</span></span><span class="level-right"><span class="level-item tag">liyin.date</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="CitruXonve&#039;s another far end" height="28"></a><p class="is-size-7"><span>&copy; 2025 Semprathlon / Simfae Dean</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Icarus Theme on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>